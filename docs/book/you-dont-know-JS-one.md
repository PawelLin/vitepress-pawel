# 你不知道的Javascript(上卷)
## 第1章 作用域是什么
1. 一套存储和访问变量的规则，这套规则称为作用域。
2. 传统编译语言的流程，Javascript大部分情况下编译发生在代码执行前的几微秒(甚至更短)。
* 分词/词法分析
* 解析/语法分析
* 代码生成
3. 编译执行过程的交互。
* 编译时：编译器 (变量声明) - 作用域 (存储和访问变量)
* 运行时：引擎 (LHS查询、RHS查询) - 作用域 (存储和访问变量)
4. 作用域嵌套。
5. LHS查询失败(非严格模式下)、RHS查询失败，引擎抛出ReferenceError异常，不合理操作，引擎抛出TypeError异常。
## 第2章 词法作用域
1. 作用域共有两种主要的工作模式
* 词法作用域 (大多数编程语言所采用)
* 动态作用域
2. 词法作用域，定义在词法阶段的作用域；提供位置信息供引擎查找标识符的位置，词法作用域查找只会查找一级标识符。
3. 在运行时执行eval函数、with函数动态插入代码来修改(欺骗)词法作用域，无法在编译阶段对作用域查找及数项性能优化。
## 第3章 函数作用域和块作用域
1. 函数作用域的含义是指，属于这个函数的全部变量都可以在整个函数的范围内使用及复用（事实上在嵌套的作用域中也可以使用）。
2. 函数作用域相当于隐藏内部实现，只向外暴露必要的内容，达到最小授权或最小暴露原则；命名冲突通过全局命名空间或模块管理进行处理。
3. 函数声明和表达式的区别，匿名和具名，具名函数的名称本身‘污染’了所在作用域，可使用立即执行函数表达式进行规避。
4. 函数作用域是最常见的作用域单元；从ES3开始，catch分句具有块作用域，块作用域是对最小授权原则进行扩展的工具，ES6引入的let为其声明的变量隐式地劫持了所在的块作用域；块作用域有利于垃圾回收机制。
## 第4章 提升
1. 任何代码被执行前包括变量和函数在内的<span style="color: var(--vp-c-red);">所有声明</span>都会首先被处理。
2. 函数声明会首先被提升，然后才是变量。块内部声明的函数也会被提升。
3. `var a = 2;`会被引擎当作两个单独的声明，第一个是编译阶段的任务，而第二个则是执行阶段的任务。
## 第5章 作用域闭包
* 闭包自己的理解<br>
按照作用域嵌套，内部作用域可以访问外部作用域变量的规则；内层函数访问外层函数的变量，即使该内层函数在外层函数以外执行也应该遵循；此时需要一个引用来捆绑外层函数作用域，从而产生一个闭包的概念，即一个无论在何处运行都可以引用到外部作用域的函数。
* 《JavaScript高级程序设计（第4版）》闭包指的是那些引用了另一个函数作用域中变量的函数，通常是在嵌套函数中实现的。 
* 【MDN】一个函数和对其周围状态（lexical environment，词法环境）的引用捆绑在一起（或者说函数被引用包围），这样的组合就是闭包（closure）。
* 闭包的使用<br>
模块模式